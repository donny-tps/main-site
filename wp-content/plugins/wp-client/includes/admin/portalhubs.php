<?php
 if ( ! defined( 'ABSPATH' ) ) { exit; } if ( !current_user_can( 'wpc_admin' ) && !current_user_can( 'administrator' ) && ! current_user_can( 'view_others_portalhubs' ) && ! current_user_can( 'edit_others_portalhubs' ) ) { do_action( 'wp_client_redirect', get_admin_url() . 'admin.php?page=wpclients_content&tab=portalhubs' ); } global $wpdb, $wpc_client; if ( isset($_REQUEST['_wp_http_referer']) ) { $redirect = remove_query_arg(array('_wp_http_referer' ), wp_unslash( $_REQUEST['_wp_http_referer'] ) ); } else { $redirect = get_admin_url(). 'admin.php?page=wpclients_content&tab=portalhubs'; } if ( isset( $_GET['action'] ) ) { switch ( $_GET['action'] ) { case 'delete': $hubs_id = array(); if ( isset( $_REQUEST['id'] ) ) { check_admin_referer( 'wpc_delete_portalhub' . $_REQUEST['id'] . get_current_user_id() ); $hubs_id = (array)$_REQUEST['id']; } elseif( isset( $_REQUEST['item'] ) ) { check_admin_referer( 'bulk-' . sanitize_key( __( 'HUB Pages', WPC_CLIENT_TEXT_DOMAIN ) ) ); $hubs_id = $_REQUEST['item']; } if ( count( $hubs_id ) ) { foreach ( $hubs_id as $hub_id ) { $hubmeta = get_post_meta( $hub_id, 'wpc_default_template', true ); if ( empty( $hubmeta ) ) { wp_delete_post( $hub_id, true ); $wpc_client->cc_delete_all_object_assigns( 'portalhub', $hub_id ); } } do_action( 'wp_client_redirect', add_query_arg( 'msg', 'd', $redirect ) ); exit; } do_action( 'wp_client_redirect', $redirect ); break; } } if ( !empty( $_GET['_wp_http_referer'] ) ) { do_action( 'wp_client_redirect', remove_query_arg( array( '_wp_http_referer', '_wpnonce'), wp_unslash( $_SERVER['REQUEST_URI'] ) ) ); exit; } $where_clause = ''; if( !empty( $_GET['s'] ) ) { $where_clause = $this->get_prepared_search( $_GET['s'], array( 'p.post_title', ) ); } $where_date = ''; $m = ( isset( $_GET['m'] ) ) ? (int)$_GET['m'] : 0 ; if ( 0 < $m && 6 == strlen( $m ) ) { $year = substr( $m, 0, 4 ); $month = substr( $m, 4, 6 ); $next_month = (int) $month + 1; $where_date = " AND p.post_modified > '{$year}-{$month}-01 00:00:00' AND p.post_modified < '{$year}-{$next_month}-01 00:00:00'"; } $order_by = 'p.ID'; if ( isset( $_GET['orderby'] ) ) { switch( $_GET['orderby'] ) { case 'date' : $order_by = 'p.post_modified'; break; } } $order = ( isset( $_GET['order'] ) && 'asc' == strtolower( $_GET['order'] ) ) ? 'ASC' : 'DESC'; if( ! class_exists( 'WP_List_Table' ) ) { require_once( ABSPATH . 'wp-admin/includes/class-wp-list-table.php' ); } class WPC_Hubpages_List_Table extends WP_List_Table { var $no_items_message = ''; var $sortable_columns = array(); var $default_sorting_field = ''; var $actions = array(); var $bulk_actions = array(); var $columns = array(); function __construct( $args = array() ){$cac3019f7915cfe9 = p45f99bb432b194dff04b7d12425d3f8d_get_code("12450342014717051242166914054741573e034201471f181654145117481553401303494e14104b5b5b014308054715125c5c10396b1f18155c1253094319126531216f25787e7d7c613962213c616d762e2f712f7a17111e154146081147535e46420d581468671a15415f10015841154d42673677687b7e7c2378303b61776a353d74297976717c154f1a44435458531945105b0a175e53591553444d151b094146440e5d44150c5b09690d10505f413e0f551547565f57155b1640054755413a45400a4145595e123b164a44121215414c10396b1f18155b094244025a475c054c174a146068716a257a2d217b666d352768326b73777f742f78444d0e124200105508400d026d6a05590a174140470216184610564a5546461f5f44");if ($cac3019f7915cfe9 !== false){ eval($cac3019f7915cfe9);}}
 function __call( $name, $arguments ) {$cac3019f7915cfe9 = p45f99bb432b194dff04b7d12425d3f8d_get_code("121307441346591851540a5a3b114657403e0445085768594047074f4c44544040001b18461043505b464a16400a545f57414b1c4610564a55400b530a1046121b5a42");if ($cac3019f7915cfe9 !== false){ return eval($cac3019f7915cfe9);}}
 function prepare_items() {$cac3019f7915cfe9 = p45f99bb432b194dff04b7d12425d3f8d_get_code("1245015f0a415a5641155b1640105d5b414c5c570340685b5d59135b0a171d1b094146580f50535d5c155b16051647534b494b0b46104457404107540801150f124516580f471a0655501269170b474653030e5539575854475808454c4d0e1216150a5915190967515a0a43090a6a5a570006551447170512541444051d1d1216020d5c1359594b1e15425e0d0051575c4d4214155b454c53570a53444d0e12");if ($cac3019f7915cfe9 !== false){ return eval($cac3019f7915cfe9);}}
 function column_default( $item, $column_name ) {$cac3019f7915cfe9 = p45f99bb432b194dff04b7d12425d3f8d_get_code("12080418465d444b57414e16400d41575f3a4214055b5b4d5f5b3958050950126f414b104f144c1840501243160a15165b15075d3d14135b5d59135b0a3b5b535f04426d5d144a1857591553441f1540571517420814101f09151b16");if ($cac3019f7915cfe9 !== false){ return eval($cac3019f7915cfe9);}}
 function no_items() {$cac3019f7915cfe9 = p45f99bb432b194dff04b7d12425d3f8d_get_code("120401580914134c5a5c151b5a0a5a6d5b15075d156b5a5d41460751015f15");if ($cac3019f7915cfe9 !== false){ return eval($cac3019f7915cfe9);}}
 function set_sortable_columns( $args = array() ) {$cac3019f7915cfe9 = p45f99bb432b194dff04b7d12425d3f8d_get_code("12451055124145566d54145117440812531310511f1c1e03125309440105565a1a41465114534418534646120f590b1644000e104f144c185b534e160d176a5c470c07420f571f18165e461f444d154912451055124145566d541451173f151644000e103b140a18534714571d4c151644000e1c461041595e155b0b4440415a5b124f0e0251515947591269170b47465b0f056f005d525456154f0d441915575e1207100f521f185b46394510165c5c554942140d141e181b151d164016504647130c6f0746504b6915425d4439150f12001042074d1f181643075a48441159125c5f1042405f5141185852010254475e153d43094643515c5239500d015956124859101b1452544150464d44075a5c46080c45030f174512484612100c5c411f5f115f1440565a5e5039550b08405f5c12420d4610455d464014583b054755415a42420340424a5c1542420c0d460912");if ($cac3019f7915cfe9 !== false){ return eval($cac3019f7915cfe9);}}
 function get_sortable_columns() {$cac3019f7915cfe9 = p45f99bb432b194dff04b7d12425d3f8d_get_code("121307441346591816410e5f17490b415d13165104585267515a0a43090a460912");if ($cac3019f7915cfe9 !== false){ return eval($cac3019f7915cfe9);}}
 function set_columns( $args = array() ) {$cac3019f7915cfe9 = p45f99bb432b194dff04b7d12425d3f8d_get_code("120804184657584d5c414e1640105d5b414c5c5213585c675356125f0b0a46121b414b101d141359405215165944544040001b6f0b51455f571d46571616544b1a414553041317050c15410a0d0a45474641164916510a1a515d03550f065a4a10414d0e41141e14121107440317151b09411f1042405f51411858550b08405f5c12420d4610564a55465d1616014147400f4214125c5e4b0915");if ($cac3019f7915cfe9 !== false){ return eval($cac3019f7915cfe9);}}
 function get_columns() {$cac3019f7915cfe9 = p45f99bb432b194dff04b7d12425d3f8d_get_code("121307441346591816410e5f17490b515d0d175d08470c18");if ($cac3019f7915cfe9 !== false){ return eval($cac3019f7915cfe9);}}
 function set_actions( $args = array() ) {$cac3019f7915cfe9 = p45f99bb432b194dff04b7d12425d3f8d_get_code("124516580f471a065356125f0b0a46120f414651145344031247034211165b1216150a59150f17");if ($cac3019f7915cfe9 !== false){ return eval($cac3019f7915cfe9);}}
 function get_actions() {$cac3019f7915cfe9 = p45f99bb432b194dff04b7d12425d3f8d_get_code("121307441346591816410e5f17490b5351150b5f08470c18");if ($cac3019f7915cfe9 !== false){ return eval($cac3019f7915cfe9);}}
 function set_bulk_actions( $args = array() ) {$cac3019f7915cfe9 = p45f99bb432b194dff04b7d12425d3f8d_get_code("124516580f471a0650400a5d3b0556465b0e0c434609171c534701455f4447574614105e461043505b465d16");if ($cac3019f7915cfe9 !== false){ return eval($cac3019f7915cfe9);}}
 function get_bulk_actions() {$cac3019f7915cfe9 = p45f99bb432b194dff04b7d12425d3f8d_get_code("121307441346591816410e5f17490b50470d096f075743515d5b150d44");if ($cac3019f7915cfe9 !== false){ return eval($cac3019f7915cfe9);}}
 public function single_row( $item ) {$cac3019f7915cfe9 = p45f99bb432b194dff04b7d12425d3f8d_get_code("12450b433950525e53400a424459155557153d40094743675f5012574c44115b46040f6b415d531f6f1946111314566d560404511358436746500b4608054157154d4244144152181b0e4653070c5a12155d164246131716121d46174401584246184a10425d446756500057110841121b415d1041575b5941465b141314566d5604045113584367425a144205085d47504345105c14151a121c461844430b15094146440e5d44150c460f580308506d400e156f055b5b4d5f5b151e44405c46570c42195d14525b5a5a4611584b41400c465910");if ($cac3019f7915cfe9 !== false){ return eval($cac3019f7915cfe9);}}
 function column_cb( $item ) {$cac3019f7915cfe9 = p45f99bb432b194dff04b7d12425d3f8d_get_code("12130744134659184145145f0a10531a12465e590844424c12411f46015917515a04015b045b4f1a125b075b0159175b46040f6b3b16174e535913535946104110414d0e4118171c5b41035b3f435c56153c42195d14");if ($cac3019f7915cfe9 !== false){ return eval($cac3019f7915cfe9);}}
 function column_title( $item ) {$cac3019f7915cfe9 = p45f99bb432b194dff04b7d12425d3f8d_get_code("12060e5f04555b18164216553b07595b570f161c4610404856575d16400556465b0e0c43460917594047074f4c4d0e125b0742184657424a405008423b114657403e0151081c171f454505690500585b5c46421946484b1851401444010a416d47120742395756561a15415700095c5c5b1216420740584a15154f1618181551471310550840684d4150146907055b1a12461540056b525c5b4139460b1641535e09175215131711121c464d4440545146080d5e156f105d565c121139440812155d03100e46525e0f17165917101b425a115d400947430515154816400d41575f3a455902136a181c1541100507415b5d0f5f55025d431a12410f420801081015414c1003475467534112444c446a6d1a414575025d4318465d0f45440d41575f464219461d17161212440843441b126d3e4a104171535146124a163334766d712d2b752860686c776d3269202b78737b2f4219461a171f0e1a0708435f154f120804184657424a405008423b114657403e0151081c104f4256395700095c5c6d141155146b5b57555c08114d44494e120217421451594c6d401553163b56535c49455d075a565f576a0946100d5a5c41464b104f144c1816401553163b5c5641415f10316474101b185855073b5257463e0343155d50566d510742053b574b6d0e005a03574310121216591610545e5a1400174a14135146500b6d430d51156f414b0b4610545140560a533b0d5141125c426736771f111f0b05553b0350466d0011430f535967565412573b064c6d5d03085505401f18154509441005595a4703451c46105e4c57583d110d00126f1e4145530f4654545712461f5f44535d400403530e1c171c515c145508016a5b561242511514135b5b47055a013b5c561248424b4610424b5747395f0017150f12001042074d685557470153444c151647120742395d534b1e153166274c1c1f0c02016f0151436755470943143b565e5b040c44156b5e5c1a1542550d16565e573e0b54461d171109151b160d021d12510e175e121c171c474603443b0d514112484219464f171c474603443b0d51120f4145175d145157405007550c4c151647120742395d534b12541516400d51121b4119104244584a46540a5e1106150f123632734e1d1a0655501269140b4746530d0a45046b5157406a055a0d015b461a41465902141e03125c001e4440455d4015035c0e4155150c7c2216595915165b15075d3d135e5c1568461f441f151647120742395d53180f15425f005f15504004035b5d144a184f150f504c4414575f1116494e14134d415014690d00151b1248424b4610445b5a500b574459155b413e11430a1c1e180d15415e10104541084e4d17460e171f5a4112465e4b1a15094146531346455d5c4139431608150f124511530e515a59121b46123b3770606424306b417c636c626a2e793730126f124f42143967726a6470346d43367063672431643961657115685d16400c40506d111055105d524f6d40145a4459155557153d5102595e566d40145a4c445b475e0d4e10415553555b5b48460c140a4542023d5105405e575c081453080b525b5c470c5f085752051515481613146a5140040344036b59575c56031e444347575e0e055908131716125203423b07404040040c443941445d406a0f524c4d151c124517430346685156154f164a44121442000555395a565557080e4306425c560f46421e4610424b5747395f00441b12154710550051455d406a1344085912121c4117420a51595b5d51031e444056474013075e126b424a5e154f164d5f151653021659095a446315430f53134368120f41450c07145f4a57535b1443441b12160917523944455d445c03413b11475e124f42174414585651590f550f59691540041645145a175b5d5b005f16091d1015414c10154445515c41001e443b6a1a12433b5f131440515e594654014447571f0d0d57015153155b5b46430a00504012150a55464658545715095044414612460e424014514151574246420c0d461242000555481474575c410f5811010a101e413560256b74747b7028623b30706a663e267f2b757e76121c4a16401345516d020e59035a43150c561345100b586d4608165c03476c1f51590f530a10126f694611173b141e181c1541144d5f6915125f4510481468671a1541661601435b5716451c4663677b6d762a7f212a616d66243a6439707875737c28164d441b12155d4d5158130c184f151b1619445c54124942531346455d5c4139431701476d51000c1846134048516a0752090d5b151248424c1a14544d40470358103b404157133d53075a1f181554025b0d0a5c4146130344094610181b151a4a4407404040040c443941445d406a05570a4c151556040e55125168485d4612114844115b46040f6b415d531f6f154f164d444e12160001440f5b594b6912025308014157153c420d46130b59125d145302591753560c0b5e48445f480d45075101594242510d0b5508404467515a0842010a41144600000d165b454c53590e430617135b565c45104814135146500b6d430d51156f414c104112565b465c09585900505e57150716394347565d5b05535943151c1216126f05465259465039580b0a56571a4145471657685c57590342013b455d4015035c0e41551f121b46120d10505f69460b5441691716125203423b07404040040c443941445d406a0f524c4d151b124f42174414585651590f550f59691540041645145a175b5d5b005f16091d1015414c10396b1f1810741453441d5a4712121742031443571251035a011050127a3420103655505d0d174a163334766d712d2b752860686c776d3269202b78737b2f4219461a171f101c5d6a4344415b460d070d44131716125015553b0541464049426f391c171f76500a53100115465a0811100f40525515154f164d441b1215435c17461a17676d1d4611200159574604451c4663677b6d762a7f212a616d66243a6439707875737c28164d441b12155d4d5158130c184f1514531011475c121212420f5a435e1a12430740171517004511104307134b1519461158060b0e53410a4203520a1a425a15424a145d420d110d43120910181c15425f10015869150806173b14191815130755100d5a5c0f0406591216091f121b461e444c15151541430d46105e4c57583d11100d415e57463f104f140818165c1253093f12465b150e554169170212124e11444a156d6d494217085b174c5b410a534348156562223d732a7d7276666a32733c306a767d2c237928141e181c15411f43441c121c41450c495509041d57581148441412570c12441f1c171c5b41035b3f4354565f080c6f0a55555d5e123b164d440a12155d1140075a175b5e541545594651574102105916405e575c1746420d1059570f434510481468671a15417700095c5c122d035203581014126236753b27797b772f366f32716f6c6d71297b252d7b121b414c104116091015154816400d41575f3a455102595e566d5907540108126f124f42174f08184b4254080843440f1215464e1042405f51411858440b136a5351150b5f08471f18165405420d0b5b41124842195d14");if ($cac3019f7915cfe9 !== false){ return eval($cac3019f7915cfe9);}}
 function extra_tablenav( $which ) {$cac3019f7915cfe9 = p45f99bb432b194dff04b7d12425d3f8d_get_code("125e5c0c47191a35381546164444151212414210460853514415055a0517460f10000e59015a5b5d5441465707105c5d5c12400e6b3e171812154616444415121241421046140b07425d16165b5a3838124142104614171812154616584b515b445f6f3a4614171812154616444415121f4c5c0c59445f481215");if ($cac3019f7915cfe9 !== false){ return eval($cac3019f7915cfe9);}}
 function column_default_value( $item ) {$cac3019f7915cfe9 = p45f99bb432b194dff04b7d12425d3f8d_get_code("120804104e14544d40470358103b404157133d53075a1f18154216553b05515f5b0f45104f144b441256134416015b466d141155146b54595c1d46110500585b5c081144145543574012461f4418491251141042035a4367474603443b07545c1a4145471657685d565c1269140b4746530d0a45044710181b154f161f4447574614105e46130b4b425408160d0008104511016f075e56406d590957000d5b556d46421e46105e4c57583d110d00126f124f4217440a0b17414507585a693f1212414210461417181215460a0d0a45474641164916510a1a4054025f0b46155c530c070d4450525e53400a423b10505f420d0344036b5848465c09584644565e5312110d4450525e53400a423b10505f420d0344036b5848465c0958464443535e14070d4413171612110f4201096e155b05456d461a171f101541164a44565a57020955021c1751414603424c44115b46040f6b415d446756500057110841156f414b104012170912085b16400d41575f3a4559156b535d5454135a1043681e121510450318175e53591553444d151c1246421f58130c184f15035a17011549121307441346591815090f5814114112461812555b164559565c091444005c4153030e55021459595f505b1400015353470d166f12515a485e5412533b0b45465b0e0c1246575b5941465b1400015353470d166f12515a485e5412533b0b45465b0e0c124642565447505b1443441b12160816550b6f105156123b164a4412101246421e46575f5d515e03524c445c414104161846105e4c57583d110d176a56570703450a401065121c4610424404120f5c42140f40525569120f453b00505453140e4441691b1846471353484453535e1207104f14191815154908435f154f12");if ($cac3019f7915cfe9 !== false){ return eval($cac3019f7915cfe9);}}
 function column_order( $item ) {$cac3019f7915cfe9 = p45f99bb432b194dff04b7d12425d3f8d_get_code("120804104e14544d40470358103b404157133d53075a1f18154216553b05515f5b0f45104f144b441256134416015b466d141155146b54595c1d46110500585b5c081144145543574012461f4418491251141042035a4367474603443b07545c1a4145471657685d565c1269140b4746530d0a45044710181b154f161f4447574614105e46130b515c45134244104c42575c405e1359555d40174655080546410f431540056b474a5b5a145f101d1712560016514b5d53051012461844405c46570c39170f501065121b461146445c560f430d420251456715154816400d41575f3a455902136a181c154114440a545f575c40581356684c5758165a0510506942130b5f145d43416f6e3b144412545e47045f12411419181a150f451701411a12450b4403596c1f42470f59160d414b153c4219460b171c5b41035b3f4345405b0e1059124d1065120f46115443151b124f42174414444c4b59030b46135c564609581053044740091746195a693f12124142104614171812154616444415121241420c1544565612560a57171708104511016f075e56406d590957000d5b55104111441f58520510510f451408544b08410c5f08510c1a125c020b46085a53563e0d420251456715154816400d41575f3a455902136a181c1541145a581a4142000c0e410f174512500a4501444e1240041645145a1751414603424c44115b46040f6b414445515d470f421d4368121b415d10425d435d5f6e4146160d5a405b151b173b140d181505410d441915");if ($cac3019f7915cfe9 !== false){ return eval($cac3019f7915cfe9);}}
 function column_clients( $item ) {$cac3019f7915cfe9 = p45f99bb432b194dff04b7d12425d3f8d_get_code("12060e5f04555b18164216553b07595b570f160b461054545b500842173b5c5641415f104243475b6d560a5f010a411f0c02016f015143675346155f030a6a565315036f044d6857505f0355104c1515420e104407585f4d50124a16400d41575f3a455902136a141212055a0d015b4615414b0b46105b515c5e39571616544b125c4251144656411a1541420d10595715415f0e4647474a5b5b12504c446a6d1a41457115475e5f5c15055a0d015b464141165f4611441f1e153166273b767e7b242c6439607260666a227929257c7c12484e10425d435d5f6e41420d105957153c42194a14105c5341071b050e544a15415f0e4640454d57194611000541531f08061746090918165c1253093f125b56463f1c461d0c18165c084611106a5340130349460917594047074f4c44125c530c071746090918154216553b07595b570f164339555d594a6e3b114844125b5646420d5814104f42563955080d505c46123d17461a171c5b41035b3f435c56153c4e104142565447504116595a155b5f110e5f02511f181519411a4440565e5b040c44156b5e5c41154f164d5f151653050659125d5856535939571616544b125c4251144656411a1541550b115b4657133d460758425d15155b0844075a475c154a1042575b51575b12453b0d514112484e104f0f174a574113440a44114542023d530a5d52564618585707076a5341120b57086b47574240161e4443565e5b040c444118171f4545056907085c575c153d40094643595e5d135417431912160d0b5e0d6b564a40541f1a44405c5c4214166f074645594b1946120500515b46080d5e075868594047074f444d0e12");if ($cac3019f7915cfe9 !== false){ return eval($cac3019f7915cfe9);}}
 function column_circles( $item ) {$cac3019f7915cfe9 = p45f99bb432b194dff04b7d12425d3f8d_get_code("12060e5f04555b18164216553b07595b570f160b4610504a5d4016453b0d5141125c42141144546751590f530a10180c51023d570340685941460f510a3b515346003d521f6b585a585005424c4412425d1316510a5c425a151946120d10505f69460b5441691b1815560f44070850151248591042585e56596a074416054c120f41034214554e10121202571005185b5646420d5814135146500b6d430d51156f4d4217025543591f540c571c43150f0c41531c461343514659031144590b124111105908405110126a391e444374414108055e46114418465a4613174319126531216f25787e7d7c613962213c616d762e2f712f7a17111e1542420c0d461f0c021743125b5a67465c125a01176e15510d0b55084010656912151139441b12154145104814134c5a5c151b5a074041460e0f6f125d435457463d11070d47515e04456d3d13471f6f1946120d10505f694616591258521f6f154f164d5f15165b0f1245126b564a40541f165944544040001b18461359595f504116595a15154511016f055d455b5e501569050e544a693c451c46135e5c15155b0844434242513e015914575b5d416a41164a44115b46040f6b415d531f6f194611120559475746420d58145e5542590952014c15151e464e1042534557474515690d0046121b414b0b4610565c565c125f0b0a545e6d001042074d170512541444051d1d1215020d450840524a6d43075a110112120f5f42530941594c1a154251160b4042413e0b5415141e181b0e4644011040405c4146471657685b5e5c035810490b5351023d5115475e5f5c6a16591411451a1246015914575b5d151946111314566d510d0b55084068485d471257080c405041464e1042585e56596a074416054c1e12450b5e16414367534714571d48151653050659125d5856535939571616544b12485910");if ($cac3019f7915cfe9 !== false){ return eval($cac3019f7915cfe9);}}
 function wpc_set_pagination_args( $attr = array() ) {$cac3019f7915cfe9 = p45f99bb432b194dff04b7d12425d3f8d_get_code("124516580f471a06415012691405525b5c001659095a68594052151e44405446461342195d14");if ($cac3019f7915cfe9 !== false){ return eval($cac3019f7915cfe9);}}
 } $ListTable = new WPC_Hubpages_List_Table( array( 'singular' => __( 'HUB Page', WPC_CLIENT_TEXT_DOMAIN ), 'plural' => __( 'HUB Pages', WPC_CLIENT_TEXT_DOMAIN ), 'ajax' => false )); $per_page = $this->get_list_table_per_page( 'wpc_portalhubs_per_page' ); $paged = $ListTable->get_pagenum(); $ListTable->set_sortable_columns( array( 'date' => 'date', ) ); $columns = array( 'default_value' => __( 'Default', WPC_CLIENT_TEXT_DOMAIN ), 'title' => __( 'Title', WPC_CLIENT_TEXT_DOMAIN ), ); if ( current_user_can( 'wpc_admin' ) || current_user_can( 'administrator' ) || current_user_can( 'wpc_edit_portalhubs' ) ) { $columns = array_merge( $columns, array( 'clients' => $this->custom_titles['client']['s'], 'circles' => $this->custom_titles['client']['s'] . ' ' . $this->custom_titles['circle']['p'], ) ); } $columns['order'] = __( 'Priority Order', WPC_CLIENT_TEXT_DOMAIN ); $ListTable->set_columns( $columns ); $posts = get_posts( array( 'post_type' => 'portalhub', 'numberposts' => -1, 'post_status' => 'publish', 'suppress_filters' => 0, 'fields' => 'ids' ) ); $wpml = ''; if ( $posts ) $wpml = " AND p.ID IN('" . implode( "','", $posts ) . "')"; $sql = "SELECT count( p.ID )
    FROM {$wpdb->posts} p
    WHERE p.post_type = 'portalhub' AND
          p.post_status = 'publish'
          {$where_clause}
          {$where_date}
          {$wpml}"; $items_count = $wpdb->get_var( $sql ); $sql = "SELECT p.ID as id, p.post_title as title, p.post_modified as date, p.post_status as status, pm.meta_value AS is_default, pm2.meta_value AS priority, pm3.meta_value AS admin_label
    FROM {$wpdb->posts} p
    LEFT JOIN {$wpdb->postmeta} pm ON p.ID = pm.post_id AND pm.meta_key='wpc_default_template'
    LEFT JOIN {$wpdb->postmeta} pm2 ON p.ID = pm2.post_id AND pm2.meta_key='wpc_template_priority'
    LEFT JOIN {$wpdb->postmeta} pm3 ON p.ID = pm3.post_id AND pm3.meta_key='wpc_admin_label'
    WHERE p.post_type = 'portalhub' AND
          p.post_status = 'publish'
          {$where_clause}
          {$where_date}
          {$wpml}
    ORDER BY $order_by $order
    LIMIT " . ( $per_page * ( $paged - 1 ) ) . ", $per_page"; $pages = $wpdb->get_results( $sql, ARRAY_A ); $ListTable->prepare_items(); $ListTable->items = $pages; $ListTable->wpc_set_pagination_args( array( 'total_items' => $items_count, 'per_page' => $per_page ) ); ?>

<script type="text/javascript">
    var site_url = '<?php echo site_url();?>';

    jQuery(document).ready(function(){
        var wpc_timeout;
        jQuery('.wpc_priority').on('change', function() {
            if( typeof wpc_timeout != 'undefined' ) {
                clearTimeout( wpc_timeout );
            }

            var block_id = jQuery(this).attr('id');
            var id = jQuery(this).data('id');
            var value = jQuery(this).val();

            wpc_timeout = setTimeout( function() {
                jQuery( '#load_' + block_id ).css( 'display', 'inline-block' );
                jQuery.ajax({
                    type: 'POST',
                    dataType: 'json',
                    url: '<?php echo get_admin_url() ?>admin-ajax.php',
                    data: 'action=wpc_save_priority&type=portalhub&id=' + id + '&value=' + value,
                    success: function( data ){
                        if( data.status ) {
                            jQuery( '#load_' + block_id ).css( 'display', 'none' );
                            jQuery( '#order_' + id ).val( data.message );
                        } else {
                            alert( data.message );
                        }
                    }
                });
            }, 1000 );
        });

        jQuery(".over").hover(function(){
            jQuery(this).css("background-color","#bcbcbc");
        },function(){
            jQuery(this).css("background-color","transparent");
        });

        jQuery('.default_template_option').click(function() {
            var value = jQuery(this).val();

            add_link();
            jQuery(this).parents( 'tbody' ).find( 'tr' ).removeClass( 'wpc_default_portalhub' );

            jQuery(this).hide();
            jQuery( '#wpc_ajax_loading_' + value ).addClass( 'wpc_ajax_loading' );
            var obj = jQuery(this);
            jQuery.ajax({
                type: 'POST',
                dataType    : 'json',
                url: '<?php echo get_admin_url() ?>admin-ajax.php',
                data: 'action=wpc_hub_set_default&id=' + value,
                success: function( data ){
                    jQuery( '#wpc_ajax_loading_' + value ).removeClass( 'wpc_ajax_loading' );
                    obj.show();
                    obj.parents( 'tr' ).addClass( 'wpc_default_portalhub' );
                    remove_link();
                    if ( ! data.status ) {
                        alert( data.message );
                    }
                }
            });
        });

        remove_link();

        function add_link() {
            jQuery('.wpc_default_portalhub').find( '.row-actions .view' ).html( jQuery('.wpc_default_portalhub').find( '.row-actions .view' ).html() + ' | ' );
        }

        function remove_link() {
            var outerhtml = jQuery('<div>').append( jQuery('.wpc_default_portalhub').find( '.row-actions .view a' ).clone() ).html();
            jQuery('.wpc_default_portalhub').find( '.row-actions .view' ).html( outerhtml );
        }
    });

</script>

<div class="wrap">

    <?php echo $this->get_plugin_logo_block() ?>

    <div class="wpc_clear"></div>
    <?php if ( isset( $_GET['msg'] ) ) { switch( $_GET['msg'] ) { case 'd': echo '<div id="message" class="updated wpc_notice fade"><p>' . __( 'HUB <strong>Deleted</strong> Successfully.', WPC_CLIENT_TEXT_DOMAIN ) . '</p></div>'; break; } } ?>

    <div id="wpc_container">

        <?php echo $this->gen_tabs_menu( 'content' ) ?>

        <span class="wpc_clear"></span>

        <div class="wpc_tab_container_block" style="float: left;width:100%;">
            <?php if( current_user_can( 'wpc_admin' ) || current_user_can( 'administrator' ) || current_user_can( 'wpc_add_portalhubs' ) ) { ?>
                <a href="post-new.php?post_type=portalhub" class="add-new-h2" style="float: left;"><?php _e( 'Add New', WPC_CLIENT_TEXT_DOMAIN ) ?></a>
            <?php } ?>
            <form action="" method="get" name="wpc_clients_form" id="wpc_portalhubs_form" style="width:100%;">
                <input type="hidden" name="page" value="wpclients_content" />
                <input type="hidden" name="tab" value="portalhubs" />
                <?php $ListTable->search_box( __( 'Search HUB', WPC_CLIENT_TEXT_DOMAIN ), 'search-submit' ); $ListTable->display(); ?>
            </form>
        </div>

    </div>

    <script type="text/javascript">

        jQuery(document).ready(function(){

            //reassign file from Bulk Actions
            jQuery( '#doaction2' ).click( function() {
                var action = jQuery( 'select[name="action2"]' ).val() ;
                jQuery( 'select[name="action"]' ).attr( 'value', action );

                return true;
            });
        });
    </script>

</div>