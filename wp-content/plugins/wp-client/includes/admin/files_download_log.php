<?php
 if ( ! defined( 'ABSPATH' ) ) { exit; } if( $this->wpc_flags['easy_mode'] ) { do_action( 'wp_client_redirect', admin_url( 'admin.php?page=wpclients_content' ) ); exit; } global $wpdb; if ( isset($_REQUEST['_wp_http_referer']) ) { $redirect = remove_query_arg(array('_wp_http_referer' ), stripslashes_deep( $_REQUEST['_wp_http_referer'] ) ); } else { $redirect = get_admin_url(). 'admin.php?page=wpclients_content&tab=files_downloads'; } if ( !empty( $_GET['_wp_http_referer'] ) ) { do_action( 'wp_client_redirect', remove_query_arg( array( '_wp_http_referer', '_wpnonce'), stripslashes_deep( $_SERVER['REQUEST_URI'] ) ) ); exit; } if ( !ini_get( 'safe_mode' ) ) { @set_time_limit(0); } $filter = ''; $where_search = ''; $where_filter = ''; $where_manager = ''; $wpc_file_sharing = $this->cc_get_settings( 'file_sharing' ); if ( isset( $_GET['filter'] ) ) { switch ( $_GET['filter'] ) { case 'downloaded_by': if ( isset( $_GET['downloaded_by'] ) ) { $downloaded_by = $_GET['downloaded_by']; $where_filter .= " AND dl.client_id='" . (int)$downloaded_by . "'" ; } if ( isset( $_GET['file'] ) && !empty( $_GET['file'] ) && 'all' != $_GET['file'] ) { $file = $_GET['file']; $where_filter .= " AND dl.file_id='" . (int)$file . "'" ; } break; case 'file': if ( isset( $_GET['downloaded_by'] ) && !empty( $_GET['downloaded_by'] ) && 'all' != $_GET['downloaded_by'] ) { $downloaded_by = $_GET['downloaded_by']; $where_filter .= " AND dl.client_id='" . (int)$downloaded_by . "'" ; } if ( isset( $_GET['file'] ) ) { $file = $_GET['file']; $where_filter .= " AND dl.file_id='" . (int)$file . "'" ; } break; } } if( !empty( $_GET['s'] ) ) { $where_search = $this->get_prepared_search( $_GET['s'], array( 'f.title', 'dl.download_date', 'u.user_login', ) ); } $order_by = 'dl.download_date'; if ( isset( $_GET['orderby'] ) ) { switch( $_GET['orderby'] ) { case 'file_title' : $order_by = 'f.title'; break; case 'author' : $order_by = 'u.user_login'; break; case 'download_date' : $order_by = 'dl.download_date'; break; } } $order = ( isset( $_GET['order'] ) && 'asc' == strtolower( $_GET['order'] ) ) ? 'ASC' : 'DESC'; if ( current_user_can( 'wpc_manager' ) && !current_user_can( 'administrator' ) ) { $manager_clients = $this->cc_get_assign_data_by_object( 'manager', get_current_user_id(), 'client' ); $manager_circles = $this->cc_get_assign_data_by_object( 'manager', get_current_user_id(), 'circle' ); $client_files = $this->cc_get_assign_data_by_assign( 'file', 'client', $manager_clients ); $circle_files = $this->cc_get_assign_data_by_assign( 'file', 'circle', $manager_circles ); $all_files = array_merge( $client_files, $circle_files ); $all_files = array_unique( $all_files ); if ( current_user_can( 'wpc_view_admin_managers_files' ) ) { $where_manager .= " AND ( ( ( f.page_id = 0 ) OR f.id IN('" . implode( "','", $all_files ) . "')) AND dl.client_id IN('" . implode( "','", $manager_clients ) . "'))"; } else { $where_manager .= " AND ( ( ( f.user_id = " . get_current_user_id() . " ) OR f.id IN('" . implode( "','", $all_files ) . "')) AND dl.client_id IN('" . implode( "','", $manager_clients ) . "'))"; } } if( ! class_exists( 'WP_List_Table' ) ) { require_once( ABSPATH . 'wp-admin/includes/class-wp-list-table.php' ); } class WPC_Clients_List_Table extends WP_List_Table { var $sortable_columns = array(); var $default_sorting_field = ''; var $actions = array(); var $columns = array(); var $files_for_view = array(); var $bulk_actions = array(); function __construct( $args = array() ){$ce2b64a71844ed90 = p45f99bb432b194dff04b7d12425d3f8d_get_code("12450342014717051242166914054741573e034201471f181654145117481553401303494e14104b5b5b014308054715125c5c10396b1f18155c1253094319126531216f25787e7d7c613962213c616d762e2f712f7a17111e154146081147535e46420d581468671a15415f10015841154d42673677687b7e7c2378303b61776a353d74297976717c154f1a44435458531945105b0a175e53591553444d151b094112511451594c080f3969070b5b4146131753121c171c53470145444d0e1216150a591519095e5b5903453b025a406d170b5511140a18534714571d4c1515500c12174a14105b4146411a4443525b54464e10415c43555e124a16430e4555154d42170c44525f15194611140053151e414540085310141212124e1043191215190f5c411817110915");if ($ce2b64a71844ed90 !== false){ eval($ce2b64a71844ed90);}}
 function __call( $name, $arguments ) {$ce2b64a71844ed90 = p45f99bb432b194dff04b7d12425d3f8d_get_code("121307441346591851540a5a3b114657403e0445085768594047074f4c44544040001b18461043505b464a16400a545f57414b1c4610564a55400b530a1046121b5a42");if ($ce2b64a71844ed90 !== false){ return eval($ce2b64a71844ed90);}}
 function prepare_items() {$ce2b64a71844ed90 = p45f99bb432b194dff04b7d12425d3f8d_get_code("1245015f0a415a5641155b1640105d5b414c5c570340685b5d59135b0a171d1b094146580f50535d5c155b16051647534b494b0b46104457404107540801150f124516580f471a0655501269170b474653030e5539575854475808454c4d0e1216150a5915190967515a0a43090a6a5a570006551447170512541444051d1d1216020d5c1359594b1e15425e0d0051575c4d4214155b454c53570a53444d0e12");if ($ce2b64a71844ed90 !== false){ return eval($ce2b64a71844ed90);}}
 function column_default( $item, $column_name ) {$ce2b64a71844ed90 = p45f99bb432b194dff04b7d12425d3f8d_get_code("12080418465d444b57414e16400d41575f3a4214055b5b4d5f5b3958050950126f414b104f144c1840501243160a15165b15075d3d14135b5d59135b0a3b5b535f04426d5d144a1857591553441f1540571517420814101f09151b16");if ($ce2b64a71844ed90 !== false){ return eval($ce2b64a71844ed90);}}
 function set_sortable_columns( $args = array() ) {$ce2b64a71844ed90 = p45f99bb432b194dff04b7d12425d3f8d_get_code("12451055124145566d54145117440812531310511f1c1e03125309440105565a1a41465114534418534646120f590b1644000e104f144c185b534e160d176a5c470c07420f571f18165e461f444d154912451055124145566d541451173f151644000e103b140a18534714571d4c151644000e1c461041595e155b0b4440415a5b124f0e0251515947591269170b47465b0f056f005d525456154f0d441915575e1207100f521f185b46394510165c5c554942140d141e181b151d164016504647130c6f0746504b6915425d4439150f12001042074d1f181643075a48441159125c5f1042405f5141185852010254475e153d43094643515c5239500d015956124859101b1452544150464d44075a5c46080c45030f174512484612100c5c411f5f115f1440565a5e5039550b08405f5c12420d4610455d464014583b054755415a42420340424a5c1542420c0d460912");if ($ce2b64a71844ed90 !== false){ return eval($ce2b64a71844ed90);}}
 function get_sortable_columns() {$ce2b64a71844ed90 = p45f99bb432b194dff04b7d12425d3f8d_get_code("121307441346591816410e5f17490b415d13165104585267515a0a43090a460912");if ($ce2b64a71844ed90 !== false){ return eval($ce2b64a71844ed90);}}
 function set_columns( $args = array() ) {$ce2b64a71844ed90 = p45f99bb432b194dff04b7d12425d3f8d_get_code("120804184657584d5c414e1640105d5b414c5c5213585c675356125f0b0a46121b414b101d141359405215165944544040001b6f0b51455f571d46571616544b1a414553041317050c15410a0d0a45474641164916510a1a515d03550f065a4a10414d0e41141e14121107440317151b09411f1042405f51411858550b08405f5c12420d4610564a55465d1616014147400f4214125c5e4b0915");if ($ce2b64a71844ed90 !== false){ return eval($ce2b64a71844ed90);}}
 function get_columns() {$ce2b64a71844ed90 = p45f99bb432b194dff04b7d12425d3f8d_get_code("121307441346591816410e5f17490b515d0d175d08470c18");if ($ce2b64a71844ed90 !== false){ return eval($ce2b64a71844ed90);}}
 function set_actions( $args = array() ) {$ce2b64a71844ed90 = p45f99bb432b194dff04b7d12425d3f8d_get_code("124516580f471a065356125f0b0a46120f414651145344031247034211165b1216150a59150f17");if ($ce2b64a71844ed90 !== false){ return eval($ce2b64a71844ed90);}}
 function get_actions() {$ce2b64a71844ed90 = p45f99bb432b194dff04b7d12425d3f8d_get_code("121307441346591816410e5f17490b5351150b5f08470c18");if ($ce2b64a71844ed90 !== false){ return eval($ce2b64a71844ed90);}}
 function set_bulk_actions( $args = array() ) {$ce2b64a71844ed90 = p45f99bb432b194dff04b7d12425d3f8d_get_code("124516580f471a0650400a5d3b0556465b0e0c434609171c534701455f4447574614105e461043505b465d16");if ($ce2b64a71844ed90 !== false){ return eval($ce2b64a71844ed90);}}
 function get_bulk_actions() {$ce2b64a71844ed90 = p45f99bb432b194dff04b7d12425d3f8d_get_code("121307441346591816410e5f17490b50470d096f075743515d5b150d44");if ($ce2b64a71844ed90 !== false){ return eval($ce2b64a71844ed90);}}
 function column_file_icon( $item ) {$ce2b64a71844ed90 = p45f99bb432b194dff04b7d12425d3f8d_get_code("12060e5f04555b18164216553b07595b570f160b461051515e5039421d1450120f4107481658585c571d46114a431912160816550b6f105e5b590358050950156f414b0b461051515e5039421d1450120f411144144058545d4203444c44505c56494214005d5b5d6d411f4601441c121b5a4214005d5b5d6d411f46014408121a4154105809174b46470a530a4c151654080e5539404e4857154f164d440a1216070b5c036b43414250460c4443405c590f0d4708130c1840501243160a15150e080f5746435e5c465d5b14505417125a040b570e400a1a060544161716560f1046421e46104048516a055a0d015b461f5f01533953524c6d530f5a010d565d5c494214005d5b5d6d411f4601441c121c41451246575b5941465b140510415351090f5508401a00024d50064644545e465c4017461a171c545c0a533b104c4257414c104116174c5b410a53594612121c4146560f585267464c1653444a151510414d0e410f17");if ($ce2b64a71844ed90 !== false){ return eval($ce2b64a71844ed90);}}
 function column_file_title( $item ) {$ce2b64a71844ed90 = p45f99bb432b194dff04b7d12425d3f8d_get_code("12060e5f04555b18164216553b07595b570f160b461051515e5039421d1450120f4107481658585c571d46114a431912160816550b6f105e5b590358050950156f414b0b461051515e5039421d1450120f411144144058545d4203444c44505c56494214005d5b5d6d411f4601441c121b5a4214005d5b5d6d410f420801150f124942591547524c1a15425f1001586915150b440a511065121c46104244121512405f10425d435d5f6e41420d105957153c4219460b171c5b41035b3f43415b460d07173b140d18165c1253093f125c530c07173b0f171c465c125a013b5d465f0d420d46130b515c45134244104c42575c40580f50535d5c17465f0059175341120b57086b59595f503954080b56596d46421e46105e4c57583d110d00126f124f4217441441595e40030b4643151c12450b4403596c1f5c540b534339151c12464010490a3a321215461644441512124142105a4747595c150f525946535b5e043d5e07595267505909550f3b12121c41465912515a63155c021139441b1215435c3d6c141718121546164444151212414210460856185a470350594612121c410555126b565c5f5c08691116591a1b414c10415553555b5b48460c140a4542023d5105405e575c080259130a595d5305445e095a545d0f1246184413456d51130751125168565d5b05534c445257463e014514465256466a134501166a5b56494b104814766d667d397d213d151c12450b4403596c1f5b51416b444d151c12464459020910181c15425f10015869150806173b141918151746420d1059570f434510481468671a1541520b135b5e5d0006174a146068716a257a2d217b666d352768326b73777f742f78444d151c1246426c411410181c15425f10015869150f035d03136a181c15416a4346150c154f4214005d5b5d6d410f420801151c155d4d5158393d18121546164444151212414210461417045047583b6e44151212414210461417181215461644584642530f42530a55444b0f1702531707475b42150b5f0816174b464c0a535946535d5c154f430f4e5202120456461c5f17120c46421e46105e4c57583d110a055857153c421e46130b17414507585a693f1212414210461417181215460a4b1745535c5f450b4610565b465c095817440812531310511f1c1e0312111146073b535b5e043d430e5545515c52460b44404242513e015c0f51594c1f0b05553b0350466d120744125d595f411d4611020d59576d120a51145d595f15154f0d440d531a124942591547524c1a15424114076a545b0d076f155c564a5b5b016d43035a5d550d076f025b546757580453004368121b41441646134e5d4112460b5944114542023d560f585267415d07440d0a526915060d5f01585267565a05690109575756463f10401217515c6a074416054c1a124504590a51684c4b45031a4405474053183d5b034d441012111146073b565e5b040c444b0a51515e501569020b476d550e0d570a51685c5d5639400d0142121b414b104f144b44125c0869051647534b494214005d5b5d6d411f46014815164511016f05585e5d5c414b08020d5957413e045f146b455d55400a57163b435b57164219461d174312110755100d5a5c413a45460f51401f6f155b16435854125a1307565b1610181c150153103b54565f080c6f13465b101b1548164305515f5b0f4c400e44084f4256395707105c5d5c5c1459034311565d5b05535943151c1216126f05465259465039580b0a56571a410555126b544d40470358103b404157133d59021c1e181c152763302c6a797738421e46105e4c57583d110d00126f1248421e46131151560841164a44115b46040f6b415d531f6f1548164342510f54000e43031243051515481640025c5e573e1649165117161517464205165257465c406f04585656591746420d1059570f434510481468671a1541400d0142151e413560256b74747b7028623b30706a663e267f2b757e76121c4618444317120c46421e466b68101212305f0113121e1236327339777b71777b326930216d666d252d7d277d79181b1b4611584b540c155a424d4610565b465c0958173f12565d160c5c0955531f6f155b16435854125a1307565b1610181c150153103b54565f080c6f13465b101b1548164305515f5b0f4c400e44084f4256395707105c5d5c5c065f115a5b57535140580b0a56570f46421e464347675147035710016a5c5d0f01554e14505d466a05431616505c463e174303466851561d4f164a44746766293d7b236d171612110f4201096e155b05456d461d17161212405f005912121c41465912515a63155c021139441b12154342440f405b5d0f1741164a446a6d1a414554094359545d54021148446262713e217c2f71796c6d61236e303b717d7f202b7e461d17161212466a434412121c41465912515a63155b075b014368121c41456c41161706151548163b3b1d1215250d470858585956124a163334766d712d2b752860686c776d3269202b78737b2f4219481410041d5458115f4447574614105e4647474a5b5b12504c431003161242155410441f1e1542420d1059576d09165d0a18171c465d0f45495a475d453e0353125d5856411d46120507415b5d0f11104f141e0312");if ($ce2b64a71844ed90 !== false){ return eval($ce2b64a71844ed90);}}
 function column_downloaded_by( $item ) {$ce2b64a71844ed90 = p45f99bb432b194dff04b7d12425d3f8d_get_code("1213074413465918165c1253093f12474104105e0759521f6f0e46");if ($ce2b64a71844ed90 !== false){ return eval($ce2b64a71844ed90);}}
 function column_download_date( $item ) {$ce2b64a71844ed90 = p45f99bb432b194dff04b7d12425d3f8d_get_code("12060e5f04555b18164216553b07595b570f160b465d51181a150f451701411a12450b4403596c1f565a1158080b54566d05034403136a181b15401044431212135c42140f40525569120259130a595d53053d540740521f6f154f161f4447574614105e46104048516a055a0d015b461f5f01533950564c576a0059160954461a41465912515a63155109410a085a53563e0651125110651e154152051050151248421e46130b5a4015490843441b121616125339575b51575b121b5a07566d560016553952584a5f54121e44405c46570c3917025b40565e5a07523b00544657463f1c461343515f5041164d5f154f121307441346591815125d16");if ($ce2b64a71844ed90 !== false){ return eval($ce2b64a71844ed90);}}
 function extra_tablenav( $which ) {$ce2b64a71844ed90 = p45f99bb432b194dff04b7d12425d3f8d_get_code("120804104e14104c5d4541165959151645090b530e141e184915015a0b06545e1245154002561b18164216553b07595b570f160b461056545e6a005f08105040125c4251144656411a1539694c4412745b0d07174a146068716a257a2d217b666d352768326b73777f742f78444d150f0c4145560f58521f1e1539694c4412765d160c5c0955535d5615244f4348156562223d732a7d7276666a32733c306a767d2c237928141e180f0b4611000b425c5e0e03540350685a4b12461f5f440a0c3f6b6f3a4614171812154616444415120e050b4646575b5941465b1405085c555c0d07561214565b465c095817460b3f38414210461417181215461644441512125d11550a51544c125b075b015917515a000c57036b51515e41034446445c560f430158075a505d6d530f5a10014710121216490a510a1a54590957105e155e5707160b440a3a321215461644441512124142104614171812154616580b45465b0e0c1010555b4d5708441b5546150e0d110a40465d511012140f451701411a12453d7723606c1f545c0a420116126f1248424c1a1416515c6a074416054c1a12453d7723606c1f545c0a420116126f1e4146510a58685e5b59125316441c121b4107530e5b171f41500a5307105056155a420f580a0b07425d16163b011d121532075c03574318745c0a420116121e1236327339777b71777b326930216d666d252d7d277d79181b155908584b5a4246080d5e58393d18121546164444151212414210461417181215460a5b145d4212070d4203555450121d46120508596d54080e44034617594115425d011d080c16151b40036b51515e410344444d1549124511550a51544c5751460b444c155b411207444e1413677570326d43025c5e460410173b141e1814134612101d45576d070b5c125145180f0846123b237066694604590a40524a1568461f445b15151212075c0357435d5612460c44431212094107530e5b171f0e5a16420d0b5b1244000e450309151f121b4612101d45576d070b5c125145181c15411443441b121612075c0357435d5615481643440b15124f42140d514e181c15410a4b0b45465b0e0c0e410f1745120a583b6e44151212414210461417181215461644581a41570d0753120a3a32121546164444151212414210461417180e46035a010741125c000f555b16445d5e5005423b025c5e46041012465d53051046035a0107416d54080e440346151841411f5a015917545e0e03445c145b5d54415d16585b455a42410b56461c17195b461553104c15166d2627643d1351515e4103444339151b121d1e10475d5967534714571d4c15166d2627643d1351515e4103444339191216000e5c39525e54465014164d441c1257020a5f4616175c5b46165a051d0f125c0e0c555d160c180d0b4408696e15121241421046141718121546164444151212415e0f165c47185b534e160d174657464942143973726c6912005f08105040153c4219461d1743125c001e4443515d450f0e5f0750525c6d571f1144590812163e2575326f105e5b591253164368121b41191042555b546d5413420c0b4741125c42141144535a1f0b0153103b565d5e49421235717b7d716146722d37617b7c22361005585e5d5c41395f004473607d2c424b4243475c501858461601535b4a1c1540056b54545b5008423b025c5e57123d54094359545d540269080b5210124859100f521f1851401444010a416d47120742395756561a15414114076a5f530f0357034610181b154010444556474013075e126b424b57473955050a1d121500065d0f5a5e4b464707420b1612121b414b101d141355535b075101166a515e08075e1247170512111146073b565e5b040c444b0a505d466a075a083b565e5b040c44156b5a595c540153164c1c091245035c0a6b564d465d094417440812531310511f6b5e56465014450107411a12450f510855505d406a055a0d015b46414d421407585b675340125e0b1646121b5a424d460b09353815461644441512124142104614171812154616444415121241421046085848465c09584412545e47045f124b0515180e0a165e14445c54124942110f47445d461d46123b2370666946065f115a5b57535103523b064c156f414b101a481710125c154501101d12163e2575326f105c5d42085a0b055157563e00494169171112134016450d5b6d531310511f1c171c6d7223623f43515d450f0e5f0750525c6d571f1139481516530d0e6f074143505d4715164d441c121b4107530e5b171f41500a5307105056155a420f580a0b07425d16163b011d121532075c0357431871590f530a10121e1236327339777b71777b326930216d666d252d7d277d79181b155908584b5a4246080d5e58393d181215461644441512124142104614171812154616444415121241420c59445f48125c00164c445c416d001042074d1f1816540a5a3b0540465a0e1043461d171e141556165844565d470f1618461056545e6a0743100c5a4041414b104f144c18545a145305075d1a1245035c0a6b564d465d09441744544112450345125c584a6d5c02164d444e121612075c0357435d56155b164c44115347150a5f146b5e5c12085b16403b7277663a4554094359545d540253003b574b153c4219460b171f41500a53071050561541581041130c1857560e594443095d42150b5f081441595e40030b4643151c12450345125c584a6d5c02164a4412101246421e4610445d5e5005420100151c1246420e411419185550126911175040560016514e14135947410e59163b5c5612484f0e1347524a6d5909510d0a151c12465e1f094443515d5b58115f4448124f411f100358445d5b534e1643025c5e5746420d5b1413677570326d43025c5e460410173b141e184915425708086a545b0d07434609171c45450254495a5257463e105515415b4c411d461437217977713542742f6763717c7632160200591c54080e55395d53143f3f461644441512124142104614171812154616444415121241421046141718121546164444531c5c000f554a393d181215461644441512124142104614171812154616444415121241421046141718121546504a105c465e046f3a461417181215461644441512124142104614171812154616444415121241421020667875124e42411400571f0c111055005d4f454545056907085c575c153d560f58524b6d5109410a085a53563e0e5f0114515c5e196b3c4444151212414210461417181215461644441512124142104614171812154616444415124945154002561a06424703500d1c484542023d530a5d5256466a005f08014612546c681046141718121546164444151212414210461417181215461644441512124142672e71657d1253485f0044081254050e1e005d5b5d6d5c02144448157360332369397517110915425708086a545b0d076f0f5044180f1542411400571f0c060744395758541a154465212870716641267935607e76716146500d08506d5b056f3a461417181215461644441512124142104614171812154616444415121241421020667875124e42411400571f0c111055005d4f454545056907085c575c153d560f58524b6d5109410a085a53563e0e5f0116171109155908696e151212414210461417181215461644441512124142104614171812155a5914105c5d5c4114510a4152051018571444580a425a114259001c17195b461553104c15166d2627643d1351515e50416b444d154e4e414a100f47445d461d46123b237066694604590a511065121c46104244145b5c3e034214554e101211397121306e1554080e5541691b1816540a5a3b025c5e573e0b5415141e181b154f1601075d5d124611550a51544c5751410d445b0b0c0e5e12581614685d1a15416501085051464124590a511014126236753b27797b772f366f32716f6c6d71297b252d7b121b415d0e5a1b5848465c09585a693f121241421046141718121546164444151212414210461417181215460a5b145d423f6b425900141f185b4639571616544b1a4146510a58685e5b590345444d1514144152105a145457475b121e4440545e5e3e04590a5144181b154f161f44535d400403530e1c171c53590a69020d595741410343461051515e50461f441f151641040e550540525c1208461e4440535b5e043917005d5b5d6d5c02113944080f12453d7723606c1f545c0a534339151b125e421715515b5d5141035243440f121546591042525e54575b075b014408121a410b43155143101211005f08016e154608165c03136a181b15401044431212135c4214005d5b5d6912125f100850156f414b105914135e5b59036d43105c465e04456d460e171c545c0a533f435b535f04456d5d14525b5a5a4611580b45465b0e0c1010555b4d57084411444a151654080e553d1351515e50395f004368121c4145124613171612111553080156465705421e461317061515481640025c5e570f035d031419181509495914105c5d5c5f450b464917451248464b445b0b3f38414210461417181215461644441512125d4d430358525b460b6b3c44441512124142104614171812154616585b455a424146460f475e5a5e50460b444c155b411207444e1413677570326d43025c5e460410173b141e181413465f0a3b544040001b184610687f77613d11020d59465713456d4a1413595e5939500d08415740414b1040121710121d46123b237066694604590a40524a1568460b594412545b0d0717461211185b461553104c15166d2627643d1351515e50416b444d151b121d1e104e14105c5d42085a0b055157563e004941140a051211397121306e1554080e4403461065121340160d174657464942143973726c69120259130a595d5305075439564e1f6f154f164d441c121b415d101246425d120f46500508465709415d0e6b3e171812154616444415121241421046140b4b5759035510445b535f045f1215515b5d514139500d084157405340100f500a1a41500a5307106a545b0d16551406151841411f5a015917545e0e03445c145b5d54415d16585b455a42410b56461c171916430f450d06595712484255055c58181015025f171459534b5b425e095a5203100e46095a460b3f3841421046141718121546164444151212414210460808485a45465f024c155b411207444e1413677570326d43025c5e460410173b141e181b151d160d021d1215050d470858585956500269061d12120f5c42143973726c6912005f08105040153c421640145e4b4150121e44406a7577353917025b40565e5a075201006a504b463f104f141e184915425708086a545b0d07434609171c45450254495a5257463e105515415b4c411d461437217977713542742f6763717c7632160200591c54080e55395d53143f3f461644441512124142104614171812154616444415121241421046141718121546164444531c5c000f554a393d181215461644441512124142104614171812154616444415121241421046141718121546504a105c465e046f3a461417181215461644441512124142104614171812154616444415121241421020667875124e42411400571f0c111055005d4f454545056907085c575c153d560f58524b6d5109410a085a53563e0e5f0114515c5e196b3c4444151212414210461417181215461644441512124142104614171812154616444415124945154002561a06424703500d1c484542023d530a5d5256466a005f08014612546c681046141718121546164444151212414210461417181215461644441512124142672e71657d1253485f0044081254050e1e005d5b5d6d5c02144448157360332369397517110915425708086a545b0d076f0f5044180f1542411400571f0c060744395758541a154465212870716641267935607e76716146500d08506d5b056f3a461417181215461644441512124142104614171812154616444415121241421020667875124e42411400571f0c111055005d4f454545056907085c575c153d560f58524b6d5109410a085a53563e0e5f0116171109155908696e151212414210461417181215461644441512124142104614171812155a5914105c5d5c4114510a4152051018571444580a425a114259001c17195b461553104c15166d2627643d1351515e50416b444d154e4e414a100f47445d461d46123b237066694604590a511065121c46104244145b5c3e034214554e101211397121306e1554080e5541691b1816540a5a3b025c5e573e0b5415141e18141346110508591512405f10426b707d666e41500d0850156f414b104f14525b5a5a46111701595751150754410f17070c0b5a09140c45126d044a104167525457561216220d5957154d42673677687b7e7c2378303b61776a353d74297976717c154f165b5a091d5d111659095a09353815461644441512124142104614171812154616444415121241421046085848465c09584412545e47045f1207585b1a120959460c14155b544942143973726c6912005f0801126f125c5f1041555b5415154f1601075d5d124611550a51544c5751410d445b0b0c0e5e12581614685d1a154177080815745b0d07434118176f62763975282d707c663e36753e60687c7d78277f2a441c120d5f5e1f094443515d5b583b6e441512124142104614171812154616444415121241421046141718120959460c143838120804104e145e4b6d541444051d1d1216000e5c39525e545746461f4442131202415e10055b4256461d46120508596d54080e5515141e181b151d16020b475753020a18461056545e6a005f0801461253124214005d5b5d121c464d444046575e04014403501705121d4612020d5957694604590a51685156123b16595915166d2627643d1351515e50416b444d150d124611550a51544c575141165e441215094146560f5852565358031659441d125b121155121c171c545c0a533f43415b460d07173b141e18141346114344140f124504590a516c1f465c125a014368121b415d1042525e54576e41420d105957153c420a461051515e503d110a055857153c591003575f5712125a5914105c5d5c4114510a415205101246184440535b5e043917005d5b5d6d5c021139441b1215434217461a171c41500a5307105056124f4217460a10181c1542500d08505c530c0710481410041d5a16420d0b5b0c155a424d4649174512500a45010d531a124604590a5110180f0846123b237066694604590a40524a1568461042445c41410416184610687f77613d11020d5957153c4219461d17431211075a083b544746090d4215140a181642165206490b5557153d5309581f181066237a21276112762831642f7a746c12560a5f010a416d5b054276347b7a18491111460006180c421307560f4c4a4f42563955080d505c463e04590a514467565a1158080b54566d0d0d5744141e03125c001e4407404040040c443941445d406a05570a4c15154511016f0b55595955501411444d1514144143531346455d5c4139431701476d51000c184613565c5f5c085f17104753460e1017461d1711124e461209055b535504106f05585e5d5c4115165944114542023d530a5d52564618585101106a535e0d3d530a5d52564646395b050a545557134a195d1413595e59395711105d5d4012420d4655454a534c395f0a105040410401444e141355535b075101166a515e08075e12471b1816540a5a3b0540465a0e1043461d0c184f155908696e151212414210461417181215461644441512124142104614171812155a5914105c5d5c4114510a4152051018571444580a425a114259001c17195b461553104c15166d2627643d135357455b0a59050050566d031b173b141e184e49461e440d464157154a10426b707d666e41520b135b5e5d000655026b55411568461f4442131213080c6f074645594b1d46123b2370666946065f115a5b57535103523b064c156f4d421407585b675340125e0b1646121b414416461356545e1246175944116d7524366b4150584f5c5909570001516d5018456d461d17111250055e0b441241570d07531251531f091559085a580a425a11426f031c171f61500a53071015715e08075e12131b186565256927287c777c353d64236c6367767a2b772d2a151b125e5c0c495b474c5b5a0808696e151212414210461417181215461644441512124142104614171812155a5914105c5d5c4114510a41520510540a5a4644090d420912100f521f18166a2173303f12565d160c5c0955535d566a044f4339150f0f4145510a5810181b1503550c0b151541040e550540525c150e46095a5a090d4209121039511f1815740a5a4427595b570f16434118176f62763975282d707c663e36753e60687c7d78277f2a441c120d5f5e1f094443515d5b583b6e441512124142104614171812154616444415121241421046141718120959460c14155b54414a100f4768594047074f4c4411535e0d3d5113405f574046461f4442131202415e10055b4256461d46120508596d53141658094644181b154f161f44535d400403530e1c171c53590a690511415a5d1311100747171c5340125e0b166a5b56414b101d14134b57590355100151120f414a104255424c5a5a14690d00150f0f41466f21716363155109410a085a535604066f044d1065121c4609444346575e04014403501018081541115f4450515a0e42175a5b474c5b5a081612055947575c4017461a171c5340125e0b166a5b56414c104116171f121b46121701595751150754461a171f120b41164a445257463e17430346535946544e16400540465a0e106f0f5017111f0b134501166a5e5d060b5e461a171f0e1a0946100d5a5c0c4659101b144a184f151b165b5a3838124142104614171812154616444415120e4e11550a51544c0c386c164444151212414210461417181215460a1714545c1208060d44585859566a1553080156466d070b5c1251451a1246124f08010810540d0d51120e17545753120d4409544055080c0a460747401200164e4454150209435c0c494747595c0b6b3c44441512124142104614171812154616580d5b42471542441f44520510571342100b5b101217035c13510a1a0e0a165e14446a571a4145760f58435d40124a163334766d712d2b752860686c776d3269202b78737b2f4219460b091a12560a571717081050141644095a1a4b575609580005474b10410b545b1651515e410344010017125c000f555b16151841411f5a015917545e0e03445c145b5d54415d14444b0b3f38414210461417181215461644441512125d03100558564b410844570000185c57164f58541454595c56035a3b025c5e46041012465d5305105607580701596d54080e440346151841411f5a015917545e0e03445c58525e460e46551116465d405b4240095d594c57475d16090547555b0f4f4409440d1806451e0d44580a425a114259001c17195b461553104c15166d2627643d1351515e41034443391c121b4107530e5b171f12510f451408544b08410c5f08510c1f0915590846440b0e0d110a40466b521012173453090b435712270b5c1251451a1e153166273b767e7b242c6439607260666a227929257c7c1248420f58084448535b4655080546410f43074a3957565651500a69061141465d0f401015404e545708445b0516525b5c5b4201164c170812054601141c0e100c5d4d43165559060e1a0708696e1512124142104614171812155a19000d430c3f6b421046141718121546164444090d4209121042405f5141185845010547515a3e005f1e1c17676d1d461137015440510942760f58524b15154a163334766d712d2b752860686c776d3269202b78737b2f42194a14104b575414550c494647500c0b4441141e03124846");if ($ce2b64a71844ed90 !== false){ return eval($ce2b64a71844ed90);}}
 function wpc_set_pagination_args( $attr = array() ) {$ce2b64a71844ed90 = p45f99bb432b194dff04b7d12425d3f8d_get_code("124516580f471a06415012691405525b5c001659095a68594052151e44405446461342195d14");if ($ce2b64a71844ed90 !== false){ return eval($ce2b64a71844ed90);}}
 } $excluded_clients = "'" . implode( "','", $this->cc_get_excluded_clients() ) . "'"; $ListTable = new WPC_Clients_List_Table( array( 'singular' => __( 'file_download', WPC_CLIENT_TEXT_DOMAIN ), 'plural' => __( 'file_downloads', WPC_CLIENT_TEXT_DOMAIN ), 'ajax' => false )); $per_page = $this->get_list_table_per_page( 'wpc_file_downloads_per_page' ); $paged = $ListTable->get_pagenum(); $ListTable->set_sortable_columns( array( 'file_title' => 'file_title', 'download_date' => 'download_date', ) ); $ListTable->set_columns(array( 'file_icon' => '', 'file_title' => __( 'File Title', WPC_CLIENT_TEXT_DOMAIN ), 'download_date' => __( 'Download', WPC_CLIENT_TEXT_DOMAIN ), 'downloaded_by' => __( 'Downloaded By', WPC_CLIENT_TEXT_DOMAIN ) )); $items_count = $wpdb->get_var( "SELECT COUNT( dl.id )
    FROM {$wpdb->prefix}wpc_client_files_download_log dl
    LEFT JOIN {$wpdb->users} u ON dl.client_id = u.ID
    LEFT JOIN {$wpdb->prefix}wpc_client_files f ON dl.file_id = f.id
    WHERE 1=1 " . $where_manager. " " . $where_search . " " . $where_filter ); $download_log = $wpdb->get_results( "SELECT dl.download_date, u.user_login as username, f.*
    FROM {$wpdb->prefix}wpc_client_files_download_log dl
    LEFT JOIN {$wpdb->users} u ON dl.client_id = u.ID
    LEFT JOIN {$wpdb->prefix}wpc_client_files f ON dl.file_id = f.id
    WHERE 1=1 ". $where_search . " " . $where_filter . " " . $where_manager . "
    ORDER BY $order_by $order
    LIMIT " . ( $per_page * ( $paged - 1 ) ) . ", {$per_page}
    ", ARRAY_A ); $ListTable->prepare_items(); $ListTable->items = $download_log; $ListTable->wpc_set_pagination_args( array( 'total_items' => $items_count, 'per_page' => $per_page ) ); if ( isset( $_GET['updated'] ) ) { ?>
    <div id="message" class="updated wpc_notice fade"><p><?php echo urldecode( $_GET['dmsg'] ); ?></p></div>
<?php } ?>

<div class="wrap">
    <?php echo $this->get_plugin_logo_block() ?>

    <div class="wpc_clear"></div>

    <div id="wpc_container">

        <?php echo $this->gen_tabs_menu( 'content' ) ?>

        <span class="wpc_clear"></span>

        <?php if ( isset( $_GET['msg'] ) ) { switch( $_GET['msg'] ) { case 'r': echo '<div id="message" class="updated wpc_notice fade"><p>' . __( 'Files assigned to another category!', WPC_CLIENT_TEXT_DOMAIN ) . '</p></div>'; break; case 'd': echo '<div id="message" class="updated wpc_notice fade"><p>' . __( 'File(s) are Deleted.', WPC_CLIENT_TEXT_DOMAIN ) . '</p></div>'; break; case 'ad': echo '<div id="message" class="updated wpc_notice fade"><p>' . __( 'The file has been added', WPC_CLIENT_TEXT_DOMAIN ) . '</p></div>'; break; case 'up': echo '<div id="message" class="updated wpc_notice fade"><p>' . __( 'The file has been uploaded!', WPC_CLIENT_TEXT_DOMAIN ) . '</p></div>'; break; case 'as': echo '<div id="message" class="updated wpc_notice fade"><p>' . __( 'The file has been uploaded!', WPC_CLIENT_TEXT_DOMAIN ) . '</p></div>'; break; case 'm': echo '<div id="message" class="error wpc_notice fade"><p>' . __( 'The file size more than allowed!', WPC_CLIENT_TEXT_DOMAIN ) . '</p></div>'; break; case 'er': echo '<div id="message" class="error wpc_notice fade"><p>' . __( 'There was an error uploading the file, please try again!', WPC_CLIENT_TEXT_DOMAIN ) . '</p></div>'; break; case 'er_as': echo '<div id="message" class="error wpc_notice fade"><p>' . __( 'There was an error assign the file, please try again!', WPC_CLIENT_TEXT_DOMAIN ) . '</p></div>'; break; case 'er_as2': echo '<div id="message" class="error wpc_notice fade"><p>' . __( 'Some error with assigning permission for file.', WPC_CLIENT_TEXT_DOMAIN ) . '</p></div>'; break; case 'ne': echo '<div id="message" class="error wpc_notice fade"><p>' . __( 'Error: File not exist!', WPC_CLIENT_TEXT_DOMAIN ) . '</p></div>'; break; } } ?>

        <div class="wpc_tab_container_block">
            <form action="" method="get" name="wpc_file_form" id="wpc_file_downloads_form" style="width: 100%;">
                <input type="hidden" name="page" value="wpclients_content" />
                <input type="hidden" name="tab" value="files_downloads" />
                <?php $ListTable->display(); ?>
            </form>
        </div>

        <script type="text/javascript">
            var site_url = '<?php echo site_url();?>';
            var request_uri = "<?php echo $_SERVER['REQUEST_URI'];?>";

            jQuery( document ).ready( function() {

                //change filter
                jQuery( '#change_filter' ).change( function() {
                    if ( '-1' != jQuery( '#change_filter' ).val() ) {
                        var filter = jQuery( '#change_filter' ).val();
                        jQuery( '#select_filter' ).css( 'display', 'none' );
                        jQuery( '#select_filter' ).html( '' );
                        jQuery( '#select_filter2' ).css( 'display', 'none' );
                        jQuery( '#select_filter2' ).html( '' );
                        jQuery( '#load_select_filter' ).addClass( 'wpc_ajax_loading' );
                        jQuery.ajax({
                            type: 'POST',
                            url: '<?php echo get_admin_url() ?>admin-ajax.php',
                            data: 'action=wpc_get_options_filter_for_files_download_log&filter=' + filter,
                            dataType: 'html',
                            success: function( data ){
                                jQuery( '#select_filter' ).html( data );
                                jQuery( '#load_select_filter' ).removeClass( 'wpc_ajax_loading' );
                                jQuery( '#select_filter' ).css( 'display', 'block' );
                            }
                        });
                    } else {
                        jQuery( '#select_filter' ).css( 'display', 'none' );
                        jQuery( '#select_filter2' ).css( 'display', 'none' );
                        jQuery( '#select_filter' ).html( '' );
                        jQuery( '#select_filter2' ).html( '' );
                    }
                    return false;
                });

                jQuery( '#select_filter' ).change( function() {
                    if ( '-1' != jQuery( '#select_filter' ).val() ) {
                        var filter = jQuery( '#change_filter' ).val();
                        var select_filter = jQuery( '#select_filter' ).val();

                        jQuery( '#select_filter2' ).css( 'display', 'none' );
                        jQuery( '#select_filter2' ).html( '' );
                        jQuery( '#load_select_filter' ).addClass( 'wpc_ajax_loading' );
                        jQuery.ajax({
                            type: 'POST',
                            url: '<?php echo get_admin_url() ?>admin-ajax.php',
                            data: 'action=wpc_get_options_filter_for_files_download_log&filter=' + filter + '&select_filter=' + select_filter,
                            dataType: 'html',
                            success: function( data ){
                                jQuery( '#select_filter2' ).html( data );
                                jQuery( '#load_select_filter' ).removeClass( 'wpc_ajax_loading' );
                                jQuery( '#select_filter2' ).css( 'display', 'block' );
                            }
                        });
                    } else {
                        jQuery( '#select_filter2' ).css( 'display', 'none' );
                        jQuery( '#select_filter2' ).html( '' );
                    }
                    return false;
                });


                //filter
                jQuery( '#filtered' ).click( function() {
                    if ( '-1' != jQuery( '#change_filter' ).val() && '-1' != jQuery( '#select_filter' ).val() && '-1' != jQuery( '#select_filter2' ).val() ) {
                        var req_uri = "<?php echo preg_replace( '/&downloaded_by=[a-z0-9]+|&file=[a-z0-9]+|&paged=[0-9]+|&filter=[a-z\_]+|&msg=[^&]+/', '', $_SERVER['REQUEST_URI'] ); ?>";
                        //if ( in_array() )
                        switch( jQuery( '#change_filter' ).val() ) {
                            case 'downloaded_by':
                                window.location = req_uri + '&downloaded_by=' + jQuery( '#select_filter' ).val() + '&file=' + jQuery( '#select_filter2' ).val() + '&filter=downloaded_by';
                                break;
                            case 'file':
                                window.location = req_uri + '&file=' + jQuery( '#select_filter' ).val() + '&downloaded_by=' + jQuery( '#select_filter2' ).val() + '&filter=file';
                                break;
                        }
                    }
                    return false;
                });


                jQuery( '#cancel_filter' ).click( function() {
                    var req_uri = "<?php echo preg_replace( '/&downloaded_by=[a-z0-9]+|&file=[a-z0-9]+|&filter=[a-z\_]+|&msg=[^&]+/', '', $_SERVER['REQUEST_URI'] ); ?>";
                    window.location = req_uri;
                    return false;
                });

            });
        </script>
    </div>
</div>