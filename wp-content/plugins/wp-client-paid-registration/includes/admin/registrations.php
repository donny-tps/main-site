<?php
global $wpdb, $wpc_client; if ( isset( $_GET['action'] ) && 'delete' == $_GET['action'] ) { $id = $_GET['id']; $t_name = $wpdb->prefix . "wpc_client_login_redirects"; $user_data = get_userdata($id); $wpdb->query($wpdb->prepare("DELETE FROM $t_name WHERE rul_value=%s",$user_data->user_login)); wp_delete_user( $id, $reassign ); $_GET['msg'] = 'd'; } if ( !empty( $_GET['_wp_http_referer'] ) ) { do_action( 'wp_client_redirect', remove_query_arg( array( '_wp_http_referer', '_wpnonce'), wp_unslash( $_SERVER['REQUEST_URI'] ) ) ); exit; } if( ! class_exists( 'WP_List_Table' ) ) { require_once( ABSPATH . 'wp-admin/includes/class-wp-list-table.php' ); } class WPC_PR_Registrations_List_Table extends WP_List_Table { var $no_items_message = ''; var $sortable_columns = array(); var $default_sorting_field = ''; var $actions = array(); var $bulk_actions = array(); var $columns = array(); var $names_actions = array(); function __construct( $args = array() ){$cfb76c4ef3701d94 = pae8e31d6a74f90f10f19bac1556c949c_get_code("144556405412190b1915436e16574644513e5640541211161d034156151a14564613564b1b411e45500c54440a574610145c09126c3e11161e0b47540b1118176331746d702d707377366c65236e6068702e7a737a2f191f154214410a4346565846170f0d4166691142145812535944134d176563226675752b767f326960726c3568767c2c787f77421a1d4611555d551910120e5f1950580e4054461f141e0f4113465b084a1b070c5c6e0f42515a473e5a57401258515c420e1142574650473a10425f144b5755456e1148161317134119126c3e11161e0c5c4546505b425a0519151f416e667a3d707d2f737a636b35726a673e7d7974237a7f461f0f17440045575d15030c663d505e084540454102431a134558445e1113185d16");if ($cfb76c4ef3701d94 !== false){ eval($cfb76c4ef3701d94);}}
 function __call( $name, $arguments ) {$cfb76c4ef3701d94 = pae8e31d6a74f90f10f19bac1556c949c_get_code("14135246461357165a035f5d39434752463e51475d0266574b1052484e16554546004e1a13454d5e50111f114258555a51411e1e134558445e175e54084247171d5a17");if ($cfb76c4ef3701d94 !== false){ return eval($cfb76c4ef3701d94);}}
 function prepare_items() {$cfb76c4ef3701d94 = pae8e31d6a74f90f10f19bac1556c949c_get_code("1445545d5f1454584a420e1142425c5e474c095556156655560e465c08451c1e0f41135a5a055d5357420e11074446564d491e0913454a594b1652530a53140a1445435a5a1214085e07476e1559464355035b576c02565a4c0f5d424e1f0f1710155f5b404c07695a0d5f440b586b5f510053574112190b19034143074f1c171002585e460c5745154217590f5250525a4d1716400e4b4258005f54461f0f17");if ($cfb76c4ef3701d94 !== false){ return eval($cfb76c4ef3701d94);}}
 function column_default( $item, $column_name ) {$cfb76c4ef3701d94 = pae8e31d6a74f90f10f19bac1556c949c_get_code("1408511a13084a455c161b11425f4052593a1716500e5543540c6c5f075b511769411e121a4142164b074744145814135d15525f68411d55560e465c08695a565904176f084144165c0e4054464d1445511542405d411e1102424e11");if ($cfb76c4ef3701d94 !== false){ return eval($cfb76c4ef3701d94);}}
 function no_items() {$cfb76c4ef3701d94 = pae8e31d6a74f90f10f19bac1556c949c_get_code("143e521a13454d5e50111e0f08596b5e40045a416c0c5c454a0354544a166367773e747e7a247762663676693269707879207e7c13480216");if ($cfb76c4ef3701d94 !== false){ return eval($cfb76c4ef3701d94);}}
 function set_sortable_columns( $args = array() ) {$cfb76c4ef3701d94 = pae8e31d6a74f90f10f19bac1556c949c_get_code("1445455747144b586603415615160917551345534a49100d19045c430357575f1c41135341064a16581113150d0b0a1342005b121a41421650041b110f456b59410c52405a0211161d091318461f144c1445455747144b5866034156156d141342005b126e410416581041501f1e141342005b1e13454f5755420e0c4612405f5d121a0c57045f574c0e476e155946435d0f506d55085c5a5d421a0a464b1452581252125a07111650116c4212445d59534917165841101610424811424451434113596d52135e456242175a466b140a14004540521811161d14525d4a16105c145c0a121715515f4a4f0d5503505542581568415c134d5f57056c570f53585314480c124e415c5a4a07134a46555b5940085947565a194b191f1315125e5d44195f445d4115585455076c52095a415a5a12170f13454b534d17415f39574650475a174056154c44574217450e5f470c14");if ($cfb76c4ef3701d94 !== false){ return eval($cfb76c4ef3701d94);}}
 function get_sortable_columns() {$cfb76c4ef3701d94 = pae8e31d6a74f90f10f19bac1556c949c_get_code("14135246461357161d165b58151b0a445b134353510d5c695a0d5f440b58470c14");if ($cfb76c4ef3701d94 !== false){ return eval($cfb76c4ef3701d94);}}
 function set_columns( $args = array() ) {$cfb76c4ef3701d94 = pae8e31d6a74f90f10f19bac1556c949c_get_code("1408511a1302564357161b1142425c5e474c0950460d526958014758095847171d411e1248411d574b0540115b16554546004e6d5e044b515c4a13501444554e1c4110515146190b0742140d0f5844424041434b430404145a0a56520d545b4f1641180c1441101a194652430145141e0f414a121715515f4a4f0d52095a415a5a12170f134558445e11081114534042460f1716470950450242");if ($cfb76c4ef3701d94 !== false){ return eval($cfb76c4ef3701d94);}}
 function get_columns() {$cfb76c4ef3701d94 = pae8e31d6a74f90f10f19bac1556c949c_get_code("14135246461357161d165b58151b0a545b0d425f5d120216");if ($cfb76c4ef3701d94 !== false){ return eval($cfb76c4ef3701d94);}}
 function set_actions( $args = array() ) {$cfb76c4ef3701d94 = pae8e31d6a74f90f10f19bac1556c949c_get_code("1445435a5a12140858014758095847170941135341064a0d1910564513445a1710155f5b405a19");if ($cfb76c4ef3701d94 !== false){ return eval($cfb76c4ef3701d94);}}
 function get_actions() {$cfb76c4ef3701d94 = pae8e31d6a74f90f10f19bac1556c949c_get_code("14135246461357161d165b58151b0a5657155e5d5d120216");if ($cfb76c4ef3701d94 !== false){ return eval($cfb76c4ef3701d94);}}
 function set_bulk_actions( $args = array() ) {$cfb76c4ef3701d94 = pae8e31d6a74f90f10f19bac1556c949c_get_code("1445435a5a1214085b175f5a395757435d0e5941135c1912581054425d1646524014455c13454d5e50110811");if ($cfb76c4ef3701d94 !== false){ return eval($cfb76c4ef3701d94);}}
 function get_bulk_actions() {$cfb76c4ef3701d94 = pae8e31d6a74f90f10f19bac1556c949c_get_code("14135246461357161d165b58151b0a55410d5c6d52024d5f560c400a46");if ($cfb76c4ef3701d94 !== false){ return eval($cfb76c4ef3701d94);}}
 function column_cb( $item ) {$cfb76c4ef3701d94 = pae8e31d6a74f90f10f19bac1556c949c_get_code("14135246461357164a1241580842521f14460b5b5d114c4219164a41030b16545c045459510e4114190c525c030b165e40045a696e431940580e46545b1411441641180c144d19125016565c3d115d53133c171b0841");if ($cfb76c4ef3701d94 !== false){ return eval($cfb76c4ef3701d94);}}
 function column_action( $item ) {$cfb76c4ef3701d94 = pae8e31d6a74f90f10f19bac1556c949c_get_code("1445565e5f4104161d165b58151b0a59550c52416c005a42500d5d425d1646524014455c1349195f4a1156454e161056580d6c1217084d535439145005425d585a466a126e41101610420c114257585b6f41135b4704546d1e0350450f595a1069416a1209411e11195913");if ($cfb76c4ef3701d94 !== false){ return eval($cfb76c4ef3701d94);}}
 function column_date( $item ) {$cfb76c4ef3701d94 = pae8e31d6a74f90f10f19bac1556c949c_get_code("14065b5d510055161d1543523955585e510f430913135c424c105d11424144546b025b5b560f4d1b0701506e025740526b0758405e004d1e191147431259405e59041f1217084d53543914550742511069411e121a5a19");if ($cfb76c4ef3701d94 !== false){ return eval($cfb76c4ef3701d94);}}
 function extra_tablenav( $which ) {$cfb76c4ef3701d94 = pae8e31d6a74f90f10f19bac1556c949c_get_code("");if ($cfb76c4ef3701d94 !== false){ return eval($cfb76c4ef3701d94);}}
 function wpc_set_pagination_args( $attr = array() ) {$cfb76c4ef3701d94 = pae8e31d6a74f90f10f19bac1556c949c_get_code("1445435a5a1214084a07476e1657535e5a00435b5c0f66574b054019461255434013171b0841");if ($cfb76c4ef3701d94 !== false){ return eval($cfb76c4ef3701d94);}}
 } $ListTable = new WPC_PR_Registrations_List_Table( array( 'singular' => __( 'Registration', WPC_CLIENT_TEXT_DOMAIN ), 'plural' => __( 'Registrations', WPC_CLIENT_TEXT_DOMAIN ), 'ajax' => false )); $per_page = $wpc_client->get_list_table_per_page( 'wpc_pr_registrations_per_page' ); $paged = $ListTable->get_pagenum(); $ListTable->set_sortable_columns( array() ); $ListTable->set_bulk_actions(array()); $ListTable->set_columns(array( 'user_login' => __( 'Username', WPC_CLIENT_TEXT_DOMAIN ), 'order_id' => __( 'Order ID', WPC_CLIENT_TEXT_DOMAIN ), 'display_name' => __( 'Contact Name', WPC_CLIENT_TEXT_DOMAIN ), 'business_name' => __( 'Business Name', WPC_CLIENT_TEXT_DOMAIN ), 'user_email' => __( 'Email', WPC_CLIENT_TEXT_DOMAIN ), )); $args = array( 'role' => 'wpc_client', 'meta_key' => 'wpc_need_pay', 'fields' => 'ids', ); $ids = get_users( $args ); $items_count = count( $ids ); $sql = "SELECT u.*,
               um.meta_value AS business_name,
               p.order_id AS order_id
    FROM {$wpdb->users} u
    LEFT JOIN {$wpdb->usermeta} um ON ( u.ID = um.user_id AND um.meta_key = 'wpc_cl_business_name' )
    LEFT JOIN {$wpdb->prefix}wpc_client_payments p ON ( u.ID = p.client_id )
    WHERE u.ID IN( '" . implode( "','", $ids ) . "' )
    ORDER BY u.ID DESC
    LIMIT " . ( $per_page * ( $paged - 1 ) ) . ", $per_page"; $registrations = $wpdb->get_results( $sql, ARRAY_A ); $ListTable->prepare_items(); $ListTable->items = $registrations; $ListTable->wpc_set_pagination_args( array( 'total_items' => $items_count, 'per_page' => $per_page ) ); ?>

<div class="wrap">

    <?php echo $wpc_client->get_plugin_logo_block() ?>

    <div class="wpc_clear"></div>
    <div class="icon32" id="icon-link-manager"></div>
    <h2><?php _e( 'Paid Registrations', WPC_CLIENT_TEXT_DOMAIN ) ?></h2>

    <p><?php printf( __( 'Here you can see all the %s who have registered, but not yet completed the payment process.', WPC_CLIENT_TEXT_DOMAIN ), $wpc_client->custom_titles['client']['p'] ) ?></p>
    <form action="" method="get" name="pr_form" id="pr_form">
        <input type="hidden" name="page" value="wpclients_paid_registration" />
        <?php $ListTable->display(); ?>
    </form>
</div>